---
sidebar: auto
title: 演習1 手順
---

[入門編の目次に戻る](../index.md)

### 実務で使えるLinux 入門編 演習手順
演習1【ファイルの操作とパーミッション】
==

## 概要
- ファイルの作成、コピー、移動、削除といったファイル操作の基本操作を学びます
- パーミッションについては、設定内容を確認するのみです。パーミッションの効果はアカウント管理の演習で学びます
- ファイルの作成と編集に使われる viエディタ の操作を学びます

## 所要時間
25分
> オプション問題の実施は自由です。時間に余裕がある場合は実施してください（これまでの講義で取り扱っていない内容が含まれることもあります）

## 実施内容
- ディレクトリの確認、作成、移動
- テキストファイルの作成と表示
- ファイルの操作
- （オプション）ハードリンクとシンボリックリンク
- パーミッション
- （オプション）vimtutor

## 演習手順

::: warning
演習を始める前に、環境にログインしてください。ログイン方法が不明な場合は講師に確認の上、以下の手順を参考にしてください
<br>
[演習環境へのログイン方法](../../howtologin/index.md)
:::

### 演習：ディレクトリの確認、作成、移動
#### 1. 現在のディレクトリを確認してください。もし、ec2-userのホームディレクトリでない場合は、ホームディレクトリに移動してください 

  ::: details 解答例
  `pwd`
  <br> 
  カレントディレクトリが /home/ec2-user でない場合は、以下も実行
  <br>
  `cd`
  :::

#### 2. 演習用のディレクトリを作成します。ホームディレクトリに、lab1 というディレクトリを作成し、そこに移動してください。移動したら、カレントディレクトリを確認してください

  ::: details 解答例
  - 以下の３コマンドを実行
  <br>
  `mkdir lab1`
  <br> 
  `cd lab1`
  <br>
  `pwd`
  :::

#### 3. lab1ディレクトリのファイル一覧を表示してください

  ::: details 解答例
  `ls`
  :::

### 演習：テキストファイルの作成と表示
#### 1. viエディタを使用して、file1.txt というファイル名でテキストファイルを作成してください。ファイルの中身は問いません
> 記載内容が思いつかない場合は以下を書き込んでください（全てで無くとも構いません）

  ```text
  Humpty Dumpty sat on a wall,
  Humpty Dumpty had a great fall.
  All the King's horses, And all the King's men
  Couldn't put Humpty together again!
  ```
  ::: details 解答例
  `vi file1.txt`
  :::

#### 2. file1.txt が問題なく作成されていることを、ファイルの中身を表示して確認してください

  ::: details 解答例
  `cat file1.txt`
  :::

### 演習：ディレクトリの作成
#### 1. 作業用ディレクトリとして、lab1ディレクトリの下に以下を作成してください

::: warning
作業前に、カレントディレクトリが lab1 であることを必ず確認してください
:::

```
dir1
dir2
dir2/dir21
dir3/dir31/dir311
```

  ::: details 解答例
  - 以下の４コマンドを実行
  <br>
  `mkdir dir1`
  <br>
  `mkdir dir2`
  <br>
  `mkdir dir2/dir21`
  <br>
  `mkdir dir3/dir31/dir311`
  :::

#### 2. うまく作成できないディレクトリがあったと思います。その原因を考え、エラーの起きない方法で再度実行してください

  ::: details 解答例
  dir2の下のdir22は、親ディレクトリであるdir2が作成されてからでないと作成できない。dir2を先に作成するか、mkdirの-pオプションを利用する。dir3も同様
  <br>
  `mkdir dir2/dir21`
  <br>
  `mkdir -p dir3/dir31/dir311`
  :::

#### 3. 必要なディレクトリが全て作成されていることを確認してください。確認の方法は問いません
  ::: details 解答例
  `ls -R`
  <br>
  など
  :::

  ::: tip
  Linuxの操作に慣れている方は、 treeコマンドを利用しても構いません。環境にインストールされていない場合は、インストールしても結構です
  :::

### 演習：ファイルの操作
::: warning
ファイルとディレクトリの操作を行うときは、絶対パスと相対パスを意識して操作してください。また、TAB補完を使い正確な作業することを意識してください。ディレクトリやファイル名を手打ちすることは作業ミスに繋がります
:::

#### 1. flle1.txt を、作成した全てのディレクトリにコピーしてください

  ::: details 解答例
  - 以下のコマンドを実行
  <br>
  `cp file1.txt dir1`
  <br>
  `cp file1.txt dir2`
  <br>
  `cp file1.txt dir2/dir21`
  <br>
  `cp file1.txt dir3/dir31/dir311`
  :::

#### 2. /etc/passwd をdir3/dir31/dir311ディレクトリにコピーしてください

  ::: details 解答例
  `cp /etc/passwd dir3/dir31/dir311`
  :::

#### 3. 各ファイルが正しくコピーできているかを確認してください。確認の方法は問いません

  ::: details 解答例
  - 以下のコマンドを実行
  <br>
  `ls dir1/`
  <br>
  `ls dir2/dir21/`
  <br>
  `ls dir3/dir31/dir311/`
  :::

#### 4. コピーした全ファイルの名前を変更をします。各ディレクトリにあるファイル名を、以下のルールに則って変更してください
  - dir2のファイルは、file2.txt
  - dir311のファイルは、file311.txt
  - dir311のpasswdは、passwd311.txt

  ::: details 解答例
  - 以下のコマンドを実行
  <br>
  `mv dir2/file1.txt dir2/file2.txt`
  <br>
  `cd dir3/dir31/dir311`
  <br>
  `mv file1.txt file311.txt`
  <br>
  `mv passwd passwd311.txt`
  :::

  ::: tip
  カレントディレクトリから離れたディレクトリでの作業は、ディレクトリを変更して操作したほうが楽なことがあります。特に作業対象が多い場合は有効です
  :::

#### 5. カレントディレクトリをdir2/dir21ディレクトリに移動し、そこに以下のファイルをコピーしてください
  - lab1/file1.txt
  - lab1/dir3/dir31/dir311/file311.txt

  ::: details 解答例
  - 以下のコマンドを実行
  <br>
  `cd dir2/dir21`
  <br>
  `cp ~/lab1/file1.txt .`
  <br>
  `cp ~/lab1/dir3/dir31/dir311/file311.txt . `
  :::

::: tip
~（チルダ）は、ホームディレクトリの絶対パスの変わりに使える便利な記号です
<br>
また、カレントディレクトリを指定する記号として .  もよく使われます。カレントディレクトリのファイルを指定するときは、./file.txt といった書き方をします
:::

::: tip
カレントディレクトリと作業ディレクトリが離れているときは絶対パスを使ったほうがよいことが多いです。うまく使い分けましょう
:::


### （オプション）演習：ハードリンクとシンボリックリンク
#### 1. カレントディレクトリをlab1に戻し、確認してください。次に、dir3/dir31/dir311/file311.txtをカレントディレクトリにコピーしてください

  ::: details 解答例
  - 以下のコマンドを実行
  <br>
  `cd ~/lab1`
  <br>
  `pwd`
  <br>
  `cp dir3/dir31/dir311/file311.txt .`
  :::

#### 2. パスが長くて作業が大変でした。このファイルにはlab1ディレクトリから素早く操作できるようにしましょう。まずはハードリンクをlab1に作成してください。名前はfile311-hardlink.txtとしてください

  ::: details 解答例
  `ln dir3/dir31/dir311/file311.txt ./file311-hardlink.txt`
  :::

#### 3. 次はシンボリックリンクを作成してください。名前は、file311-symlink.txtとしてください

  ::: details 解答例
  `ln -s dir3/dir31/dir311/file311.txt ./file311-symlink.txt`
  :::

#### 4. 結果を確認してください。ハードリンクとシンボリックリンクではどこが違うでしょうか？

  ::: details 解答例
  `ls -l`
  <br>
  ハードリンクは、リンク数が２となっている。シンボリックリンクでは１で、矢印でリンク先を表示している
  :::

#### 5. リンク元のファイルの情報を表示してください。結果はどうでしょうか？

  ::: details 解答例
  `ls -l dir3/dir31/dir311/file311.txt`
  <br>
  ハードリンクされているのでリンク数が２となっている。シンボリックリンクされているかはわからない
  :::

### 演習：パーミッション
#### 1. dir3/dir31/dir311/passwd311.txtのパーミッションを確認し、誰に何ができるかを把握してください

  ::: details 解答例
  - 以下のコマンドを実行
  <br>
  `cd ~/lab1/dir3/dir31/dir311/`
  <br>
  `ls -l passwd311.txt`
  <br>
  rw-r--r-- なので、所有者の読み書き、グループとそれ以外のユーザーには読み込みのみしかできない
  :::

#### 2. 誰も読み取りしかできないようにパーミッションを変更してください。方法は問いません

  ::: details 解答例
  `chmod a-w passwd311.txt`
  <br>
  もしくは
  <br>
  `chmod 444 passwd311.txt`
  :::

#### 3. 所有者ですら書き込みができなくなったことを、viで編集して確認してください。

  ::: details 解答例
  `vi passwd311.txt` を実行しファイルを編集しても、編集後の保存ができない
  <br> 
  :q! で終了する
  :::

#### 4. 次に、/etc/sudoersファイルの中身を表示してみてください（表示に使うコマンドは自由です）。うまくいったでしょうか？

  ::: details 解答例
  `cat /etc/sudoers` などを実行
  <br>
  許可がない（Permission Denied）が表示され実行できない
  :::

::: tip
/etc/sudoersは、管理者権限を与えるユーザーを管理するファイルです。第4章に記載があります
:::

#### 5. 原因を調査し、中身の表示が可能かどうかを考察してください

  ::: details 解答例
  `ls -l /etc/sudoers` を実行しパーミッションを確認する
  <br>
  所有者がrootユーザーであり、その他のユーザーへの権限が一切ないことから、現在ログイン中のユーザーでは参照も権限の変更もできない
  :::

### （オプション）演習：vimtutor
#### 1. 演習が早く終わり時間のある方は、vimtutorコマンドを実行し、viエディタを学習してください

::: tip
Skillable及びHyper-V環境の場合は、日本語表示ができないため英語版でのみ実施可能です。GUI環境（GNOMEなど）をインストールして日本語での利用は可能ですので、講義終了後に環境が利用できるようであればGUIをインストールして日本語でのvimtutorを実行してみても良いかもしれません。（GUIのインストールには時間がかかります。講義中は時間が足りなくなるので、GUIのインストールを実施しないほうが無難です）
:::

## 演習終了
- 以上で演習1は終了です。お疲れ様でした。早く終わった方は、復習や周りのメンバーのヘルプを行いましょう

---

[入門編の目次に戻る](../index.md)
<br>

[トップページに戻る](../../index.md)