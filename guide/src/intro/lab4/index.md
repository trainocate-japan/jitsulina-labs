---
sidebar: auto
title: 演習4 目次
---

[入門編の目次に戻る](../index.md)

### 実務で使えるLinux 入門編
演習4【プロセス管理とパッケージ管理】
==

## 概要
- アプリケーションソフトウェアの管理単位であるプロセスの基本的な確認方法や操作方法を学びます
- アプリケーションパッケージのインストールとアンインストール、代表的なパッケージ管理コマンドであるdnfやrpmの基本的な操作方法を学びます 
## 所要時間
30分
## 実施内容
- プロセスの稼働状況の確認
- （オプション）ジョブの管理
- パッケージ管理とサーバープロセスの管理
## 演習内容
### 演習：プロセスの稼働状況の確認
#### 1. プロセス一覧を確認するコマンドを実行してください。表示形式は問いません

  ::: details 解答例
  `ps`
  :::

#### 2. プロセス一覧を確認するコマンドを実行してください。今回は、全てのプロセスを詳細に長いフォーマットで表示してください

  ::: details 解答例
  `ps -ef`
  :::

#### 3. 全てのユーザーのbashプロセスのみを表示してください。パイプラインを使いましょう。フォーマットは問いません

  ::: details 解答例
  `ps -ef|grep bash`
  :::

#### 4. ツリー状に全プロセスを表示し、PIDが1番のプロセスが何かを確認してください

  ::: details 解答例
  `pstree -p`
  :::

#### 5. 現在稼働中のプロセスをリアルタイムで確認できるコマンドを実行し、最もcpuを使用しているプロセス名を確認してください。確認が終わったら実行したコマンドを終了しておいてください

  ::: details 解答例
  `top`
  <br>
  q キーで終了
  :::

#### 6. 「vmstat」を実行してください。何がおきるでしょうか？

  ::: details 解答例
  メモリの状況やCPU使用率などが1行、表示される
  :::

#### 7. 次は「vmstat 1」を実行してください。何がおきるでしょうか？またどうすれば停止できるでしょうか？

  ::: details 解答例
  メモリの状況やCPU使用率などが1秒ごとに表示される。Ctrl+C キーを押すことで停止
  :::

### （オプション）演習：ジョブの管理
#### 1. vmstat 1 を実行し、その結果をsystem-status.txt ファイルに保存してください。10秒ほど実行したら保存を停止してください

  ::: details 解答例
  `vmstat 1 > system-status.txt`
  <br>
  Ctrl + C キーで停止
  :::

#### 2. 実行したvmstat 1 の結果が画面に表示されなかった理由はなんでしょうか？

  ::: details 解答例
  出力リダイレクトでファイルに出力していたため
  :::

#### 3. system-status.txt を表示してvmstatの実行結果を確認してください

  ::: details 解答例
  `cat system-status.txt`
  :::

#### 4. 現在時刻をsystem-status.txtの最後に追記しておいてください。次に進む前に結果を確認してください

  ::: details 解答例
  `date >> system-status.txt` の実行後、`cat system-status.txt` で確認
  <br>
  ファイルの最後にdateコマンドの結果が記載されていればよい
  :::

#### 5. 再びvmstat 1 を実行します。system-status.txtファイルに結果を追記していくように出力リダイレクトしてください
  :::warning
  出力リダイレクトの仕方を間違えるとこれまでの記録が全て消えますので十分注意してください
  :::

  ::: details 解答例
  `vmstat 1 >> system-status.txt`
  :::

#### 6. vmstat 1 がフォアグラウンドで実行されているため、このままではシェルの操作を行えません。vmstat 1 の実行を一時停止してください

  ::: details 解答例
  Ctrl + Z キーを押す
  :::

#### 7. このままではファイルへの記録が止まったままです。バックグラウンドで処理を続行してください

  ::: details 解答例
  `jobs`
  <br>
  ジョブ番号を確認
  <br>
  `bg ジョブ番号`
  :::

#### 8. ジョブの状況を確認してください。vmstat 1 は実行中(running)ですか？

  ::: details 解答例
  `jobs`
  :::

#### 9. tail -f system-status.txt コマンドを実行して結果を確認し、何が起きているかを説明してください。確認が終わったらtailコマンドを終了してください

  :::tip
  tail -f は、更新されているファイルの末尾をリアルタイムに表示し続けるコマンドです
  :::

  ::: details 解答例
  vmstat 1 はバックグラウンドで実行され、system-status.txtを更新し続けている
  :::

#### 10. vmstat 1 の実行を終了してください。方法は何でも構いません

  ::: details 解答例
  `ps|grep vmstat` で実行中のvmstatのプロセスIDを確認し、`kill プロセスID`でkillする
  <br>
  もしくは
  <br>
  `fg vmstatのジョブ番号`でフォアグランドに移動させたあと、Ctrl + C キーで終了
  <br>
  など
  :::

### 演習：パッケージ管理とサーバープロセスの管理

:::danger
パッケージ管理やサーバープロセスの操作はroot権限が必要です。演習では root ユーザーでの作業を行いますが、実務ではsudoなど安全な方法を使ってください。また、パスワードについても非常に簡単なものを設定していますが、実務では予想不可能な文字を使うように心がけてください
:::

#### 1. rootユーザーに変更してください。方法は問いません（演習環境によって方法は異なります）

  ::: details 解答例
  `sudo su -`
  <br>
  もしくは
  <br>
  `su -`
  <br>
  続けてパスワードを入力
  :::

#### 2. httpd (Apache Web Server) が、まだインストールされていないことを確認してください。確認方法は問いません

  ::: details 解答例
  `rpm -qa|grep httpd`
  など
  :::

#### 3. httpd (Apache Web Server) を dnf コマンドでインストールしてください

  ::: details 解答例
  `dnf install httpd`
  :::

#### 4. httpd を起動し、正常に起動したことを確認してください。可能であれば、curlコマンドなどでWebアクセスをしてみてください。その際、表示される量が多いので、表示量を制限したりページ送りのできるコマンドをパイプラインで利用してください

  ::: details 解答例
  `systemctl start httpd`を実行後、`systemctl status httpd`で動作確認
  <br>
  `curl http://localhost|head`でWebページを表示
  <br>
  ※表示量が多いため、headコマンドをパイプして最初の10行のみ表示
  :::

#### 5. httpd を停止してください。停止を確認後、アンインストールしてください

  ::: details 解答例
  - 以下のコマンドを続けて実行
  <br>
  `systemctl stop httpd`
  <br>
  `systemctl status httpd`
  <br>
  `dnf remove httpd`
  :::

#### 6. httpd がアンインストールされたことを確認してください。方法は問いません

  ::: details 解答例
  `rpm -qa|grep httpd`
  など
  :::

#### 7. dnfコマンドを使い、httpd のRPMパッケージファイルをカレントディレクトリにダウンロードしてください。ダウンロードができたことも確認してください

  ::: details 解答例
  `dnf download httpd`でダウンロード後、`ls -l`でファイル名を確認
  :::

#### 8. rpmコマンドを使って、ダウンロードしたrpmファイルをインストールしてください。結果はどうでしょうか？

  ::: details 解答例
  `rpm -ivh httpd-2.4.57-8.el9.x86_64.rpm`
  <br>
  エラー（依存性の欠如）が発生し、インストールできない
  :::

#### 9. dnfコマンドでは問題なくhttpdをインストールできたのに、rpmコマンドではできなかった理由を考察してください
  ::: details 解答例
  dnfコマンドでは、依存関係にあるRPMパッケージも同時にダウンロードしていた。rpmコマンドでは単体のパッケージのインストールしか行わないため、依存関係を解決できずにエラーとなった
  :::

## 演習終了
- 以上で演習4は終了です。お疲れ様でした。早く終わった方は、復習や周りのメンバーのヘルプを行いましょう

---
[入門編の目次に戻る](../index.md)
<br>

[トップページに戻る](../../index.md)